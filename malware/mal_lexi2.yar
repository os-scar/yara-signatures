rule lexi2
{
    meta:
        description = "Detects specific code pattern related to spawning a child process"

    strings:
        $pattern1 = "const { spawn } = require('child_process')" ascii wide
        $pattern2 = "const child = spawn('node', ['index.js']" ascii wide
        $pattern3 = "detached: true" ascii wide
        $pattern4 = "stdio: 'ignore'" ascii wide
        $pattern5 = "child.unref()" ascii wide

    condition:
        all of them
}
